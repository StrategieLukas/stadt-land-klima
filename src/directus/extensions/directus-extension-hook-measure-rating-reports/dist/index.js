import e from"path";import{writeFileSync as s}from"fs";var t=({schedule:t},{services:a,database:n,getSchema:o})=>{const{ItemsService:i}=a;t("*/1 * * * *",async()=>{console.log("1 minute has passed");const t=new i("ratings_measures",{database:n,schema:await o()}),a=await t.readByQuery({limit:-1}),r=e.join(process.cwd(),"/extensions/directus-extension-hook-measure-rating-reports"),c=`timestamp-${Date.now()}.txt`,m=e.join(r,c),p=function(e){const s=JSON.parse(e),t=Object.keys(s[0]),a=s.map(e=>t.map(s=>`"${null!==e[s]?e[s]:""}"`).join(","));return`${t.join(",")}\n${a.join("\n")}`}(JSON.stringify(a));s(m,p,{flag:"w"})})};export{t as default};
