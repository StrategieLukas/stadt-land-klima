import{resolveComponent as e,openBlock as t,createElementBlock as a,createVNode as n,createElementVNode as i,toDisplayString as r,Fragment as s,renderList as d}from"vue";var o=[],l=[];!function(e,t){if(e&&"undefined"!=typeof document){var a,n=!0===t.prepend?"prepend":"append",i=!0===t.singleTag,r="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var s=o.indexOf(r);-1===s&&(s=o.push(r)-1,l[s]={}),a=l[s]&&l[s][n]?l[s][n]:l[s][n]=d()}else a=d();65279===e.charCodeAt(0)&&(e=e.substring(1)),a.styleSheet?a.styleSheet.cssText+=e:a.appendChild(document.createTextNode(e))}function d(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var a=Object.keys(t.attributes),i=0;i<a.length;i++)e.setAttribute(a[i],t.attributes[a[i]]);var s="prepend"===n?"afterbegin":"beforeend";return r.insertAdjacentElement(s,e),e}}("\n.measure-preview[data-v-faeedd16] {\n  --v-notice-padding: 12px 16px;\n}\n.measure-content[data-v-faeedd16] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.field-preview[data-v-faeedd16] {\n  background-color: var(--theme--background-subdued);\n  border: 1px solid var(--theme--border-color-subdued);\n  border-radius: var(--theme--border-radius);\n  padding: 12px 16px;\n  transition: border-color var(--fast) var(--transition);\n}\n.field-preview[data-v-faeedd16]:hover {\n  border-color: var(--theme--border-color);\n}\n.field-header[data-v-faeedd16] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n  color: var(--theme--foreground-subdued);\n}\n.field-header .v-icon[data-v-faeedd16] {\n  --v-icon-color: var(--theme--primary);\n}\n.field-label[data-v-faeedd16] {\n  font-weight: 600;\n  font-size: 14px;\n  color: var(--theme--foreground);\n}\n.field-content[data-v-faeedd16] {\n  color: var(--theme--foreground);\n  font-size: 14px;\n  line-height: 1.5;\n}\n.field-content.empty[data-v-faeedd16] {\n  color: var(--theme--foreground-subdued);\n  font-style: italic;\n}\n.field-content[data-v-faeedd16] p {\n  margin: 0 0 8px 0;\n}\n.field-content[data-v-faeedd16] p:last-child {\n  margin-bottom: 0;\n}\n.field-content[data-v-faeedd16] ul,\n.field-content[data-v-faeedd16] ol {\n  margin: 8px 0;\n  padding-left: 20px;\n}\n.field-content[data-v-faeedd16] li {\n  margin-bottom: 4px;\n}\n.loading-container[data-v-faeedd16] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 16px;\n  color: var(--theme--foreground-subdued);\n}\n.loading-text[data-v-faeedd16] {\n  font-size: 14px;\n}\n.v-notice[data-v-faeedd16] {\n  --v-notice-margin: 0;\n}\n",{});var c=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a};const u={name:"MeasurePreview",inject:["api"],props:{value:{default:null},field:{type:String,required:!0},collection:{type:String,required:!0},primaryKey:{type:[String,Number],default:null},measure_field:{type:String,default:"measure_id"},fields_to_display:{type:Array,default:()=>["description_about","description_evaluation_criteria","description_verification"]}},data:()=>({measureId:null,measureData:{},loading:!1,error:null,fieldsToDisplay:[],currentItem:null}),computed:{measureField(){return this.measure_field||"measure_id"}},watch:{primaryKey:{immediate:!0,handler(e){e&&this.fetchCurrentItem()}}},mounted(){this.fieldsToDisplay=this.fields_to_display,this.primaryKey&&this.fetchCurrentItem()},methods:{async fetchCurrentItem(){if(this.primaryKey&&this.api)try{const e=await this.api.get(`/items/${this.collection}/${this.primaryKey}`);this.currentItem=e.data.data;const t=this.currentItem[this.measureField];t&&(this.measureId=t,this.fetchMeasure(t))}catch(e){console.error("[MeasurePreview] Error fetching current item:",e)}},async fetchMeasure(e){if(e&&this.api){this.loading=!0,this.error=null;try{const t=await this.api.get(`/items/measures/${e}`,{params:{fields:this.fieldsToDisplay.join(",")}});t.data&&t.data.data?this.measureData=t.data.data:this.measureData=t.data||{}}catch(e){console.error("[MeasurePreview] Error fetching measure:",e),this.error=e.message||this.$t("failed_to_fetch_measure_data"),this.measureData={}}finally{this.loading=!1}}},getFieldLabel(e){if(this.$stores)try{const{useFieldsStore:t}=this.$stores(),a=t().getField("measures",e);if(a&&a.meta&&a.meta.translations){const e=this.$i18n?.locale||"en-US",t=a.meta.translations.find(t=>t.language===e);if(t&&t.translation)return t.translation}if(a&&a.meta&&a.meta.field)return a.meta.field}catch(e){console.warn("Could not get field translation:",e)}return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}}},f={class:"measure-preview"},m={key:0,class:"v-notice info"},p={class:"content"},v={class:"title"},h={key:1,class:"loading-container"},g={class:"loading-text"},y={key:2,class:"v-notice danger"},_={class:"content"},b={class:"title"},x={class:"text"},w={key:3,class:"measure-content"},D={class:"field-header"},k={class:"field-label"},$=["innerHTML"],I={key:1,class:"field-content empty"},T={key:4,class:"v-notice warning"},F={class:"content"},S={class:"title"};var M={id:"measure-preview",name:"Measure Preview",icon:"info",description:"Displays selected measure fields inline in ratings_measures",component:c(u,[["render",function(o,l,c,u,M,j){const C=e("v-icon"),A=e("v-progress-circular");return t(),a("div",f,[M.measureId?M.loading?(t(),a("div",h,[n(A,{indeterminate:""}),i("span",g,r(o.$t("loading_measure_data")),1)])):M.error?(t(),a("div",y,[n(C,{name:"error"}),i("div",_,[i("div",b,r(o.$t("error")),1),i("div",x,r(M.error),1)])])):M.measureData&&Object.keys(M.measureData).length>0?(t(),a("div",w,[(t(!0),a(s,null,d(M.fieldsToDisplay,e=>(t(),a("div",{key:e,class:"field-preview"},[i("div",D,[n(C,{name:"info",small:""}),i("span",k,r(j.getFieldLabel(e)),1)]),M.measureData[e]?(t(),a("div",{key:0,class:"field-content",innerHTML:M.measureData[e]},null,8,$)):(t(),a("div",I,r(o.$t("no_content_available")),1))]))),128))])):(t(),a("div",T,[n(C,{name:"warning"}),i("div",F,[i("div",S,r(o.$t("no_measure_data_available")),1)])])):(t(),a("div",m,[n(C,{name:"info"}),i("div",p,[i("div",v,r(o.$t("no_measure_selected")),1)])]))])}],["__scopeId","data-v-faeedd16"],["__file","interface.vue"]]),types:["string","integer","bigInteger","json","text"],localTypes:["standard"],group:"other",options:[{field:"measure_field",type:"string",name:"Measure Reference Field",meta:{width:"full",note:"Field in this collection that relates to measures",interface:"input"},schema:{default_value:"measure_id"}},{field:"fields_to_display",type:"json",name:"Fields to Display",meta:{width:"full",note:"Fields from the measure to display (as JSON array)",interface:"input-code",options:{language:"json"}},schema:{default_value:'["description_about","description_evaluation_criteria","description_verification"]'}}]};export{M as default};
